@using Domain.Ticket.TicketHistory
@model Ticket

<div class="container mt-4">
    <div class="card shadow-sm" style="min-width: 300px;">
        <div class="card-header bg-primary text-white">
            <h5>Ticket Solver</h5>
        </div>
        <div class="card-body">
            <!-- Current Solver Info -->
            <p><strong>Assigned Solver:</strong> <span class="badge bg-success">@Model.SolverChanges?.Solver.Name</span></p>
            <p><strong>Solver Type:</strong> @Model.SolverChanges?.Solver.UserType</p>

            <!-- Solver History -->
            <h6 class="mt-3">Solver History</h6>
            <ul class="list-group list-group-flush">
                @{                    
                    SolverChange? change = Model.SolverChanges;
                    @while (change != null)
                    {
                        <li class="border-1 list-group-item">
                            <strong>@change.Solver.Name</strong> - @change.Description
                            <br />
                            <small class="text-muted">@change.TimeCreated.ToShortDateString()</small>
                        </li>

                        change = change.PreviousTransition;
                    }                    
                }
            </ul>

            <!-- Change Solver Form -->
            <h6 class="mt-3">Change Solver</h6>
            <form asp-action="ChangeSolver" method="post">
                <input type="hidden" name="ticketId" value="@Model.Id" />
                <select class="form-select mb-2" name="newSolver" required>
    @*                 @foreach (var solver in Model.AvailableSolvers)
                    {
                        <option value="@solver">@solver</option>
                    } *@
                </select>
                <button type="submit" class="btn btn-primary w-100">Assign Solver</button>
            </form>
        </div>
    </div>
</div>